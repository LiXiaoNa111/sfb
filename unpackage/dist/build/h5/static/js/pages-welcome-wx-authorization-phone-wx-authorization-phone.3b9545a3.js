(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-welcome-wx-authorization-phone-wx-authorization-phone"],{"0ef0":function(t,e,a){var i=a("5c13");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("4f06").default;n("9c56133a",i,!0,{sourceMap:!1,shadowMode:!1})},"267a":function(t,e,a){"use strict";var i=a("b656"),n=a.n(i);n.a},"2cea":function(t,e,a){"use strict";var i=a("0ef0"),n=a.n(i);n.a},"30ea":function(t,e,a){"use strict";a("a9e3"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={name:"tuiModal",props:{show:{type:Boolean,default:!1},width:{type:String,default:"84%"},padding:{type:String,default:"40rpx 64rpx"},radius:{type:String,default:"24rpx"},title:{type:String,default:""},content:{type:String,default:""},color:{type:String,default:"#999"},size:{type:Number,default:28},shape:{type:String,default:"square"},button:{type:Array,default:function(){return[{text:"取消",type:"red",plain:!0},{text:"确定",type:"red",plain:!1}]}},maskClosable:{type:Boolean,default:!0},fadeIn:{type:Boolean,default:!1},custom:{type:Boolean,default:!1}},data:function(){return{}},methods:{handleClick:function(t){if(this.show){var e=t.currentTarget.dataset;this.$emit("click",{index:Number(e.index)})}},handleClickCancel:function(){this.maskClosable&&this.$emit("cancel")}}};e.default=i},"3c9f":function(t,e,a){"use strict";a.r(e);var i=a("54db"),n=a("cf16");for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("2cea");var r,d=a("f0c5"),l=Object(d["a"])(n["default"],i["b"],i["c"],!1,null,"aa3cb0c6",null,!1,i["a"],r);e["default"]=l.exports},"54db":function(t,e,a){"use strict";a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return i}));var i={tuiModal:a("cbe5").default},n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",[a("myh5"),a("v-uni-view",{staticClass:"content"},[a("v-uni-button",{staticClass:"regis",attrs:{"open-type":"getPhoneNumber"},on:{getphonenumber:function(e){arguments[0]=e=t.$handleEvent(e),t.getPhoneNumber.apply(void 0,arguments)}}},[t._v("微信用户快速登录")]),a("v-uni-view",{staticStyle:{"flex-wrap":"wrap",display:"flex","flex-direction":"row","margin-top":"24rpx",color:"#A2A2A2"}},[a("v-uni-view",[t._v("登录即表示您已阅读并同意")]),a("v-uni-view",{staticStyle:{color:"#0062CC"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toService.apply(void 0,arguments)}}},[t._v("《尚方宝使用协议》")]),a("v-uni-view",[t._v("和")]),a("v-uni-view",{staticStyle:{color:"#0062CC"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toPrivacy.apply(void 0,arguments)}}},[t._v("《尚方宝隐私政策》")])],1),a("v-uni-view",{staticClass:"view",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.show2.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"view1"},[t._v("暂不登录")]),a("v-uni-view",{staticClass:"view2"})],1),a("tui-modal",{attrs:{show:t.modal2,title:"警示",content:"不登录将无法使用该小程序,快去登录吧!!!",color:"#333",size:32,button:t.button3},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handleClick2.apply(void 0,arguments)},cancel:function(e){arguments[0]=e=t.$handleEvent(e),t.hide2.apply(void 0,arguments)}}})],1)],1)},o=[]},"54df":function(t,e,a){var i=a("24fb");e=i(!1),e.push([t.i,'.tui-modal-box[data-v-25d1b3a9]{position:fixed;left:50%;top:50%;margin:auto;background-color:#fff;z-index:9999998;-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out;opacity:0;box-sizing:border-box;visibility:hidden}.tui-modal-scale[data-v-25d1b3a9]{-webkit-transform:translate(-50%,-50%) scale(0);transform:translate(-50%,-50%) scale(0)}.tui-modal-normal[data-v-25d1b3a9]{-webkit-transform:translate(-50%,-50%) scale(1);transform:translate(-50%,-50%) scale(1)}.tui-modal-show[data-v-25d1b3a9]{opacity:1;visibility:visible}.tui-modal-mask[data-v-25d1b3a9]{position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.6);z-index:9999996;-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out;opacity:0;visibility:hidden}.tui-mask-show[data-v-25d1b3a9]{visibility:visible;opacity:1}.tui-modal-title[data-v-25d1b3a9]{text-align:center;font-size:%?34?%;color:#333;padding-top:%?20?%;font-weight:700}.tui-modal-content[data-v-25d1b3a9]{text-align:center;color:#999;font-size:%?28?%;padding-top:%?20?%;padding-bottom:%?60?%}.tui-mtop[data-v-25d1b3a9]{margin-top:%?30?%}.tui-mbtm[data-v-25d1b3a9]{margin-bottom:%?30?%}.tui-modalBtn-box[data-v-25d1b3a9]{width:100%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.tui-flex-column[data-v-25d1b3a9]{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.tui-modal-btn[data-v-25d1b3a9]{width:46%;height:%?68?%;line-height:%?68?%;position:relative;border-radius:%?10?%;font-size:%?26?%;overflow:visible;margin-left:0;margin-right:0}.tui-modal-btn[data-v-25d1b3a9]::after{content:" ";position:absolute;width:200%;height:200%;-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:scale(.5);transform:scale(.5);left:0;top:0;border-radius:%?20?%}.tui-btn-width[data-v-25d1b3a9]{width:80%!important}.tui-primary[data-v-25d1b3a9]{background:#5677fc;color:#fff}.tui-primary-hover[data-v-25d1b3a9]{background:#4a67d6;color:#e5e5e5}.tui-primary-outline[data-v-25d1b3a9]{color:#5677fc;background:transparent}.tui-primary-outline[data-v-25d1b3a9]::after{border:1px solid #5677fc}.tui-danger[data-v-25d1b3a9]{background:#ed3f14;color:#fff}.tui-danger-hover[data-v-25d1b3a9]{background:#d53912;color:#e5e5e5}.tui-danger-outline[data-v-25d1b3a9]{color:#ed3f14;background:transparent}.tui-danger-outline[data-v-25d1b3a9]::after{border:1px solid #ed3f14}.tui-red[data-v-25d1b3a9]{background:#e41f19;color:#fff}.tui-red-hover[data-v-25d1b3a9]{background:#c51a15;color:#e5e5e5}.tui-red-outline[data-v-25d1b3a9]{color:#e41f19;background:transparent}.tui-red-outline[data-v-25d1b3a9]::after{border:1px solid #e41f19}.tui-warning[data-v-25d1b3a9]{background:#ff7900;color:#fff}.tui-warning-hover[data-v-25d1b3a9]{background:#e56d00;color:#e5e5e5}.tui-warning-outline[data-v-25d1b3a9]{color:#ff7900;background:transparent}.tui-warning-outline[data-v-25d1b3a9]::after{border:1px solid #ff7900}.tui-green[data-v-25d1b3a9]{background:#19be6b;color:#fff}.tui-green-hover[data-v-25d1b3a9]{background:#16ab60;color:#e5e5e5}.tui-green-outline[data-v-25d1b3a9]{color:#19be6b;background:transparent}.tui-green-outline[data-v-25d1b3a9]::after{border:1px solid #19be6b}.tui-white[data-v-25d1b3a9]{background:#fff;color:#333}.tui-white-hover[data-v-25d1b3a9]{background:#f7f7f9;color:#666}.tui-white-outline[data-v-25d1b3a9]{color:#333;background:transparent}.tui-white-outline[data-v-25d1b3a9]::after{border:1px solid #333}.tui-gray[data-v-25d1b3a9]{background:#ededed;color:#999}.tui-gray-hover[data-v-25d1b3a9]{background:#d5d5d5;color:#898989}.tui-gray-outline[data-v-25d1b3a9]{color:#999;background:transparent}.tui-gray-outline[data-v-25d1b3a9]::after{border:1px solid #999}.tui-outline-hover[data-v-25d1b3a9]{opacity:.6}.tui-circle-btn[data-v-25d1b3a9]{border-radius:%?40?%!important}.tui-circle-btn[data-v-25d1b3a9]::after{border-radius:%?80?%!important}',""]),t.exports=e},"57aa":function(t,e,a){"use strict";var i;a.d(e,"b",(function(){return n})),a.d(e,"c",(function(){return o})),a.d(e,"a",(function(){return i}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-uni-view",{on:{touchmove:function(e){e.stopPropagation(),e.preventDefault(),arguments[0]=e=t.$handleEvent(e)}}},[a("v-uni-view",{staticClass:"tui-modal-box",class:[t.fadeIn||t.show?"tui-modal-normal":"tui-modal-scale",t.show?"tui-modal-show":""],style:{width:t.width,padding:t.padding,borderRadius:t.radius}},[t.custom?a("v-uni-view",[t._t("default")],2):a("v-uni-view",[t.title?a("v-uni-view",{staticClass:"tui-modal-title"},[t._v(t._s(t.title))]):t._e(),a("v-uni-view",{staticClass:"tui-modal-content",class:[t.title?"":"tui-mtop"],style:{color:t.color,fontSize:t.size+"rpx"}},[t._v(t._s(t.content))]),a("v-uni-view",{staticClass:"tui-modalBtn-box",class:[2!=t.button.length?"tui-flex-column":""]},[t._l(t.button,(function(e,i){return[a("v-uni-button",{key:i+"_0",staticClass:"tui-modal-btn",class:["tui-"+(e.type||"primary")+(e.plain?"-outline":""),2!=t.button.length?"tui-btn-width":"",t.button.length>2?"tui-mbtm":"","circle"==t.shape?"tui-circle-btn":""],attrs:{"hover-class":"tui-"+(e.plain?"outline":e.type||"primary")+"-hover","data-index":i},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handleClick.apply(void 0,arguments)}}},[t._v(t._s(e.text||"确定"))])]}))],2)],1)],1),a("v-uni-view",{staticClass:"tui-modal-mask",class:[t.show?"tui-mask-show":""],on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.handleClickCancel.apply(void 0,arguments)}}})],1)},o=[]},"5c13":function(t,e,a){var i=a("24fb");e=i(!1),e.push([t.i,".content[data-v-aa3cb0c6]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;padding:%?59?%}.view[data-v-aa3cb0c6]{width:auto;margin-top:%?24?%;-webkit-align-self:center;align-self:center}.view1[data-v-aa3cb0c6]{font-size:%?30?%;color:#afafaf}.view2[data-v-aa3cb0c6]{width:100%;height:%?1?%;background-color:#afafaf;margin-top:%?-5?%}.regis[data-v-aa3cb0c6]{border-radius:3px;background-color:#10be62;margin-top:%?130?%;color:#fff;font-size:%?34?%;height:%?100?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;width:100%}",""]),t.exports=e},7748:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={onLoad:function(t){this.type=t.type,console.log("到绑定手机号页面的type为："+this.type),this.wxData=JSON.parse(decodeURIComponent(t.data)),this.signature=JSON.parse(decodeURIComponent(t.signature)),this.rawData=JSON.parse(decodeURIComponent(t.rawData))},data:function(){return{type:"",wxData:{},signature:"",rawData:"",phone:"",modal2:!1,button3:[{text:"确定",type:"red"}]}},methods:{show2:function(){this.modal2=!0},hide2:function(){this.modal2=!1},handleClick2:function(t){t.index;this.hide2(),uni.navigateBack()},toService:function(){uni.navigateTo({url:"../../web-view/agreement-web-view?type=1"})},toPrivacy:function(){uni.navigateTo({url:"../../web-view/agreement-web-view?type=2"})},getPhoneNumber:function(t){console.log("点击手机号授权");var e=this;wx.checkSession({success:function(a){console.log("有效啊"),console.log(t.detail),"getPhoneNumber:fail user deny"==t.detail.errMsg?(console.log("拒绝手机号授权"),e.show2()):(console.log("同意手机号授权"),e.getPhone(t.detail))},fail:function(){console.log("session_key 已经失效，需要重新执行登录流程"),this.$u.toast("已经失效，需要重新执行登录流程"),setTimeout((function(){uni.navigateBack()}),500)}})},getPhone:function(t){var e=this,a=uni.getStorageSync(this.SESSIONKEY);this.$u.get(this.miniWXPhoneUrl,{sessionKey:a,signature:e.signature,rawData:e.rawData,encryptedData:t.encryptedData,iv:t.iv}).then((function(t){console.log("获取手机号"),console.log(t.data.phoneNumber),0==t.status&&(e.phone=t.data.phoneNumber,e.bandPhone())}))},bandPhone:function(){var t=this;this.$u.get(this.customerWXPhoneUrl,{openId:this.wxData.openId,nickName:this.wxData.nickName,gender:this.wxData.gender,avatarUrl:this.wxData.avatarUrl,unionId:this.wxData.unionId,phone:this.phone}).then((function(e){console.log(e),0==e.status&&t.login(e.data)})).catch((function(e){t.$u.toast(e.msg)}))},login:function(t){this.$u.toast("授权登录成功"),uni.setStorageSync(this.ISLOGIN,!0),uni.setStorageSync(this.TOKEN,t.token),uni.setStorageSync(this.ID,t.id),uni.$emit(this.LOGINSOCKET,""),uni.setStorageSync(this.IPHONE,t.phone),uni.setStorageSync(this.CLINICNAME,t.clinicName),uni.setStorageSync(this.HEADIMG,t.avatar),uni.setStorageSync(this.NAME,t.userName),uni.setStorageSync(this.READ,!0),1==t.state&&uni.setStorageSync(this.ISID,!0),uni.$emit(this.INFORMLOGIN,"更新登录状态"),20==this.type?uni.reLaunch({url:"../../clinic-doctor/clinic-doctor"}):uni.switchTab({url:"../../diagnosis/diagnosis"})}}};e.default=i},a231:function(t,e,a){"use strict";a.r(e);var i=a("30ea"),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e["default"]=n.a},b656:function(t,e,a){var i=a("54df");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=a("4f06").default;n("44c41b28",i,!0,{sourceMap:!1,shadowMode:!1})},cbe5:function(t,e,a){"use strict";a.r(e);var i=a("57aa"),n=a("a231");for(var o in n)"default"!==o&&function(t){a.d(e,t,(function(){return n[t]}))}(o);a("267a");var r,d=a("f0c5"),l=Object(d["a"])(n["default"],i["b"],i["c"],!1,null,"25d1b3a9",null,!1,i["a"],r);e["default"]=l.exports},cf16:function(t,e,a){"use strict";a.r(e);var i=a("7748"),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,(function(){return i[t]}))}(o);e["default"]=n.a}}]);