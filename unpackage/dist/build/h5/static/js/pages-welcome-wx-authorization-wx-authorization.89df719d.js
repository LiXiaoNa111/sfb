(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-welcome-wx-authorization-wx-authorization"],{1193:function(t,a,e){var i=e("24fb");a=i(!1),a.push([t.i,"uni-page-body[data-v-97911e36]{background-color:#fff}.content[data-v-97911e36]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-align:start;-webkit-align-items:flex-start;align-items:flex-start;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;padding:%?59?%}.txt1[data-v-97911e36]{font-size:%?36?%;color:#000;font-weight:700;margin-top:%?50?%}.txt2[data-v-97911e36]{font-size:%?30?%;color:#000;margin-top:%?120?%}.txt3[data-v-97911e36]{font-size:%?30?%;color:#afafaf;margin-top:%?12?%}.view[data-v-97911e36]{width:auto;margin-top:%?24?%;-webkit-align-self:center;align-self:center}.view1[data-v-97911e36]{font-size:%?30?%;color:#afafaf}.view2[data-v-97911e36]{width:100%;height:%?1?%;background-color:#afafaf;margin-top:%?-5?%}.regis[data-v-97911e36]{border-radius:3px;background-color:#10be62;margin-top:%?77?%;color:#fff;font-size:%?34?%;height:%?100?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;width:100%}body.?%PAGE?%[data-v-97911e36]{background-color:#fff}",""]),t.exports=a},"15d1":function(t,a,e){"use strict";var i=e("986b"),n=e.n(i);n.a},"166e":function(t,a,e){"use strict";e.r(a);var i=e("d3d7"),n=e.n(i);for(var o in i)"default"!==o&&function(t){e.d(a,t,(function(){return i[t]}))}(o);a["default"]=n.a},"267a":function(t,a,e){"use strict";var i=e("b656"),n=e.n(i);n.a},"30ea":function(t,a,e){"use strict";e("a9e3"),Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i={name:"tuiModal",props:{show:{type:Boolean,default:!1},width:{type:String,default:"84%"},padding:{type:String,default:"40rpx 64rpx"},radius:{type:String,default:"24rpx"},title:{type:String,default:""},content:{type:String,default:""},color:{type:String,default:"#999"},size:{type:Number,default:28},shape:{type:String,default:"square"},button:{type:Array,default:function(){return[{text:"取消",type:"red",plain:!0},{text:"确定",type:"red",plain:!1}]}},maskClosable:{type:Boolean,default:!0},fadeIn:{type:Boolean,default:!1},custom:{type:Boolean,default:!1}},data:function(){return{}},methods:{handleClick:function(t){if(this.show){var a=t.currentTarget.dataset;this.$emit("click",{index:Number(a.index)})}},handleClickCancel:function(){this.maskClosable&&this.$emit("cancel")}}};a.default=i},"54df":function(t,a,e){var i=e("24fb");a=i(!1),a.push([t.i,'.tui-modal-box[data-v-25d1b3a9]{position:fixed;left:50%;top:50%;margin:auto;background-color:#fff;z-index:9999998;-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out;opacity:0;box-sizing:border-box;visibility:hidden}.tui-modal-scale[data-v-25d1b3a9]{-webkit-transform:translate(-50%,-50%) scale(0);transform:translate(-50%,-50%) scale(0)}.tui-modal-normal[data-v-25d1b3a9]{-webkit-transform:translate(-50%,-50%) scale(1);transform:translate(-50%,-50%) scale(1)}.tui-modal-show[data-v-25d1b3a9]{opacity:1;visibility:visible}.tui-modal-mask[data-v-25d1b3a9]{position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.6);z-index:9999996;-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out;opacity:0;visibility:hidden}.tui-mask-show[data-v-25d1b3a9]{visibility:visible;opacity:1}.tui-modal-title[data-v-25d1b3a9]{text-align:center;font-size:%?34?%;color:#333;padding-top:%?20?%;font-weight:700}.tui-modal-content[data-v-25d1b3a9]{text-align:center;color:#999;font-size:%?28?%;padding-top:%?20?%;padding-bottom:%?60?%}.tui-mtop[data-v-25d1b3a9]{margin-top:%?30?%}.tui-mbtm[data-v-25d1b3a9]{margin-bottom:%?30?%}.tui-modalBtn-box[data-v-25d1b3a9]{width:100%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between}.tui-flex-column[data-v-25d1b3a9]{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.tui-modal-btn[data-v-25d1b3a9]{width:46%;height:%?68?%;line-height:%?68?%;position:relative;border-radius:%?10?%;font-size:%?26?%;overflow:visible;margin-left:0;margin-right:0}.tui-modal-btn[data-v-25d1b3a9]::after{content:" ";position:absolute;width:200%;height:200%;-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-transform:scale(.5);transform:scale(.5);left:0;top:0;border-radius:%?20?%}.tui-btn-width[data-v-25d1b3a9]{width:80%!important}.tui-primary[data-v-25d1b3a9]{background:#5677fc;color:#fff}.tui-primary-hover[data-v-25d1b3a9]{background:#4a67d6;color:#e5e5e5}.tui-primary-outline[data-v-25d1b3a9]{color:#5677fc;background:transparent}.tui-primary-outline[data-v-25d1b3a9]::after{border:1px solid #5677fc}.tui-danger[data-v-25d1b3a9]{background:#ed3f14;color:#fff}.tui-danger-hover[data-v-25d1b3a9]{background:#d53912;color:#e5e5e5}.tui-danger-outline[data-v-25d1b3a9]{color:#ed3f14;background:transparent}.tui-danger-outline[data-v-25d1b3a9]::after{border:1px solid #ed3f14}.tui-red[data-v-25d1b3a9]{background:#e41f19;color:#fff}.tui-red-hover[data-v-25d1b3a9]{background:#c51a15;color:#e5e5e5}.tui-red-outline[data-v-25d1b3a9]{color:#e41f19;background:transparent}.tui-red-outline[data-v-25d1b3a9]::after{border:1px solid #e41f19}.tui-warning[data-v-25d1b3a9]{background:#ff7900;color:#fff}.tui-warning-hover[data-v-25d1b3a9]{background:#e56d00;color:#e5e5e5}.tui-warning-outline[data-v-25d1b3a9]{color:#ff7900;background:transparent}.tui-warning-outline[data-v-25d1b3a9]::after{border:1px solid #ff7900}.tui-green[data-v-25d1b3a9]{background:#19be6b;color:#fff}.tui-green-hover[data-v-25d1b3a9]{background:#16ab60;color:#e5e5e5}.tui-green-outline[data-v-25d1b3a9]{color:#19be6b;background:transparent}.tui-green-outline[data-v-25d1b3a9]::after{border:1px solid #19be6b}.tui-white[data-v-25d1b3a9]{background:#fff;color:#333}.tui-white-hover[data-v-25d1b3a9]{background:#f7f7f9;color:#666}.tui-white-outline[data-v-25d1b3a9]{color:#333;background:transparent}.tui-white-outline[data-v-25d1b3a9]::after{border:1px solid #333}.tui-gray[data-v-25d1b3a9]{background:#ededed;color:#999}.tui-gray-hover[data-v-25d1b3a9]{background:#d5d5d5;color:#898989}.tui-gray-outline[data-v-25d1b3a9]{color:#999;background:transparent}.tui-gray-outline[data-v-25d1b3a9]::after{border:1px solid #999}.tui-outline-hover[data-v-25d1b3a9]{opacity:.6}.tui-circle-btn[data-v-25d1b3a9]{border-radius:%?40?%!important}.tui-circle-btn[data-v-25d1b3a9]::after{border-radius:%?80?%!important}',""]),t.exports=a},"57aa":function(t,a,e){"use strict";var i;e.d(a,"b",(function(){return n})),e.d(a,"c",(function(){return o})),e.d(a,"a",(function(){return i}));var n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-uni-view",{on:{touchmove:function(a){a.stopPropagation(),a.preventDefault(),arguments[0]=a=t.$handleEvent(a)}}},[e("v-uni-view",{staticClass:"tui-modal-box",class:[t.fadeIn||t.show?"tui-modal-normal":"tui-modal-scale",t.show?"tui-modal-show":""],style:{width:t.width,padding:t.padding,borderRadius:t.radius}},[t.custom?e("v-uni-view",[t._t("default")],2):e("v-uni-view",[t.title?e("v-uni-view",{staticClass:"tui-modal-title"},[t._v(t._s(t.title))]):t._e(),e("v-uni-view",{staticClass:"tui-modal-content",class:[t.title?"":"tui-mtop"],style:{color:t.color,fontSize:t.size+"rpx"}},[t._v(t._s(t.content))]),e("v-uni-view",{staticClass:"tui-modalBtn-box",class:[2!=t.button.length?"tui-flex-column":""]},[t._l(t.button,(function(a,i){return[e("v-uni-button",{key:i+"_0",staticClass:"tui-modal-btn",class:["tui-"+(a.type||"primary")+(a.plain?"-outline":""),2!=t.button.length?"tui-btn-width":"",t.button.length>2?"tui-mbtm":"","circle"==t.shape?"tui-circle-btn":""],attrs:{"hover-class":"tui-"+(a.plain?"outline":a.type||"primary")+"-hover","data-index":i},on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.handleClick.apply(void 0,arguments)}}},[t._v(t._s(a.text||"确定"))])]}))],2)],1)],1),e("v-uni-view",{staticClass:"tui-modal-mask",class:[t.show?"tui-mask-show":""],on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.handleClickCancel.apply(void 0,arguments)}}})],1)},o=[]},"986b":function(t,a,e){var i=e("1193");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=e("4f06").default;n("25c7d534",i,!0,{sourceMap:!1,shadowMode:!1})},a231:function(t,a,e){"use strict";e.r(a);var i=e("30ea"),n=e.n(i);for(var o in i)"default"!==o&&function(t){e.d(a,t,(function(){return i[t]}))}(o);a["default"]=n.a},b656:function(t,a,e){var i=e("54df");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var n=e("4f06").default;n("44c41b28",i,!0,{sourceMap:!1,shadowMode:!1})},c22d:function(t,a,e){"use strict";e.d(a,"b",(function(){return n})),e.d(a,"c",(function(){return o})),e.d(a,"a",(function(){return i}));var i={tuiModal:e("cbe5").default},n=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("v-uni-view",[e("myh5"),e("v-uni-view",{staticClass:"content"},[e("v-uni-view",{staticClass:"txt1"},[t._v("欢迎加入尚方宝！")]),e("v-uni-view",{staticClass:"txt2"},[t._v("请确认授权以下信息")]),e("v-uni-view",{staticClass:"txt3"},[t._v("获取你的公开信息(昵称、头像等)")]),e("v-uni-button",{staticClass:"regis",attrs:{"open-type":"getUserInfo",withCredentials:"true"},on:{getuserinfo:function(a){arguments[0]=a=t.$handleEvent(a),t.getWXSessionkey.apply(void 0,arguments)}}},[t._v("微信授权")]),e("v-uni-view",{staticClass:"view",on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.show2.apply(void 0,arguments)}}},[e("v-uni-view",{staticClass:"view1"},[t._v("暂不授权")]),e("v-uni-view",{staticClass:"view2"})],1),e("tui-modal",{attrs:{show:t.modal2,title:"警示",content:"您点击了拒绝授权，部分功能无法使用!!!",color:"#333",size:32,button:t.button3},on:{click:function(a){arguments[0]=a=t.$handleEvent(a),t.handleClick2.apply(void 0,arguments)},cancel:function(a){arguments[0]=a=t.$handleEvent(a),t.hide2.apply(void 0,arguments)}}})],1)],1)},o=[]},cbe5:function(t,a,e){"use strict";e.r(a);var i=e("57aa"),n=e("a231");for(var o in n)"default"!==o&&function(t){e.d(a,t,(function(){return n[t]}))}(o);e("267a");var r,d=e("f0c5"),s=Object(d["a"])(n["default"],i["b"],i["c"],!1,null,"25d1b3a9",null,!1,i["a"],r);a["default"]=s.exports},cca8:function(t,a,e){"use strict";e.r(a);var i=e("c22d"),n=e("166e");for(var o in n)"default"!==o&&function(t){e.d(a,t,(function(){return n[t]}))}(o);e("15d1");var r,d=e("f0c5"),s=Object(d["a"])(n["default"],i["b"],i["c"],!1,null,"97911e36",null,!1,i["a"],r);a["default"]=s.exports},d3d7:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i={onLoad:function(t){this.type=t.type,console.log("跳转到微信登录页面"),console.log(this.type)},onUnload:function(){this.islogin=uni.getStorageSync(this.ISLOGIN),this.islogin||1!=this.type?this.islogin||2!=this.type||uni.$emit(this.INFORMBACKLOGINWXME,""):uni.$emit(this.INFORMBACKLOGINWX,"")},data:function(){return{islogin:"",type:"",code:"",signature:"",rawData:"",encryptedData:"",iv:"",modal2:!1,button3:[{text:"确定",type:"red"}]}},methods:{getWXSessionkey:function(){var t=this;console.log("点击了去授权"),uni.login({provider:"weixin",success:function(a){console.log("获取到微信code"),console.log(a.code),t.$u.get(t.miniWXKeyUrl,{code:a.code}).then((function(a){0==a.status&&t.login(a.data)})).catch((function(a){uni.setStorageSync(t.SESSIONKEY,a.data.msg),1==a.data.status&&t.mGetUserInfo(a.data.msg)}))},fail:function(t){console.log("授权失败"),console.log(t)}})},mGetUserInfo:function(t){var a=this,e=this;console.log("sessionKey"+t),uni.getUserInfo({provider:"weixin",success:function(a){console.log("用户同意授权"),console.log(a),e.signature=a.signature,e.rawData=a.rawData,e.encryptedData=a.encryptedData,e.iv=a.iv,e.$u.get(e.miniWXInfoUrl,{sessionKey:t,signature:e.signature,rawData:e.rawData,encryptedData:e.encryptedData,iv:e.iv}).then((function(t){0==t.status&&(console.log("接口成"),console.log(t),e.login(t.data))})).catch((function(t){console.log("无账号 新用户 去注册"),console.log(t),e.ddd(t.data)}))},fail:function(t){console.log("用户拒绝授权",t),a.show2()}})},ddd:function(t){100==t.status?uni.navigateTo({url:"../wx-authorization-phone/wx-authorization-phone?type="+this.type+"&data="+encodeURIComponent(JSON.stringify(t.data))+"&signature="+encodeURIComponent(JSON.stringify(this.signature))+"&rawData="+encodeURIComponent(JSON.stringify(this.rawData))}):1==t.status&&this.$u.toast(t.msg)},show2:function(){this.modal2=!0},hide2:function(){this.modal2=!1},handleClick2:function(t){t.index;this.hide2(),uni.navigateBack()},login:function(t){this.$u.toast("授权登录成功"),uni.setStorageSync(this.ISLOGIN,!0),uni.setStorageSync(this.TOKEN,t.token),uni.setStorageSync(this.ID,t.id),uni.$emit(this.LOGINSOCKET,""),uni.setStorageSync(this.IPHONE,t.phone),uni.setStorageSync(this.CLINICNAME,t.clinicName),uni.setStorageSync(this.HEADIMG,t.avatar),uni.setStorageSync(this.NAME,t.userName),uni.setStorageSync(this.READ,!0),1==t.state&&uni.setStorageSync(this.ISID,!0),uni.$emit(this.INFORMLOGIN,"更新登录状态"),20==this.type?uni.reLaunch({url:"../../clinic-doctor/clinic-doctor"}):uni.switchTab({url:"../../diagnosis/diagnosis"})}}};a.default=i}}]);