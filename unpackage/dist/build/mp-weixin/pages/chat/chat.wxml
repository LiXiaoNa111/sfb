<view><view data-event-opts="{{[['touchstart',[['hideDrawer',['$event']]]]]}}" class="content" bindtouchstart="__e"><scroll-view class="msg-list" scroll-y="true" scroll-with-animation="{{scrollAnimation}}" scroll-top="{{scrollTop}}" scroll-into-view="{{scrollToView}}" upper-threshold="50" data-event-opts="{{[['scrolltoupper',[['loadHistory',['$event']]]]]}}" bindscrolltoupper="__e"><block wx:if="{{isHistoryLoading}}"><view class="loading"><view class="spinner"><view class="rect1"></view><view class="rect2"></view><view class="rect3"></view><view class="rect4"></view><view class="rect5"></view></view></view></block><block wx:for="{{$root.l0}}" wx:for-item="row" wx:for-index="index" wx:key="index"><view class="row" id="{{'msg'+row.$orig.id}}"><block wx:if="{{row.$orig.sendId!=account&&row.$orig.mediaType!=4}}"><view class="my"><view class="left"><block wx:if="{{row.$orig.mediaType==1}}"><view class="bubble"><rich-text nodes="{{row.$orig.content}}"></rich-text></view></block><block wx:if="{{row.$orig.mediaType==6}}"><view data-event-opts="{{[['tap',[['playVoice',['$0','$1'],[[['messageList','',index,'content']],[['messageList','',index,'id']]]]]]]}}" class="{{['bubble voice',playMsgid==row.$orig.id?'play':'']}}" bindtap="__e"><view class="length">{{row.$orig.length+"''"}}</view><view class="icon my-voice"></view></view></block><block wx:if="{{row.$orig.mediaType==2}}"><view data-event-opts="{{[['tap',[['showPic',['$0'],[[['messageList','',index,'content']]]]]]]}}" class="bubble img" bindtap="__e"><image lazy-load="{{true}}" mode="aspectFill" src="{{row.$orig.content+'?x-oss-process=image/resize,l_150'}}"></image></view></block><block wx:if="{{row.$orig.mediaType==7}}"><view class="bubble video"><view data-event-opts="{{[['tap',[['toVideo',['$0'],[[['messageList','',index,'content']]]]]]]}}" style="position:relative;" bindtap="__e"><image style="border-radius:12rpx;width:250rpx;height:300rpx;" src="{{row.$orig.content+'?x-oss-process=video/snapshot,t_1000,m_fast'}}" mode="aspectFill"></image><view data-event-opts="{{[['tap',[['toVideo',['$0'],[[['messageList','',index,'content']]]]]]]}}" style="width:100%;height:100%;position:absolute;top:0%;left:0%;display:flex;flex-direction:column;align-items:center;justify-content:center;" bindtap="__e"><image style="width:50rpx;height:50rpx;" src="../../static/image/icon_play.png" mode="aspectFill"></image></view></view></view></block></view><view class="right"><image style="border-radius:100rpx;" mode="aspectFill" src="{{imageUrl==null?'../../static/image/icon_tx_nor.png':imageUrl}}"></image></view></view></block><block wx:if="{{row.$orig.mediaType==3}}"><view data-event-opts="{{[['tap',[['toUpbill',['$0'],[[['messageList','',index,'recordId']]]]]]]}}" class="view-right" bindtap="__e"><view class="right-time">{{row.$orig.createTime}}</view><view class="right-media-type-up">{{row.$orig.content}}</view></view></block><block wx:if="{{row.$orig.mediaType==4}}"><view data-event-opts="{{[['tap',[['tobill',['$0'],[[['messageList','',index,'recordId']]]]]]]}}" class="view-right" bindtap="__e"><view class="right-time">{{row.$orig.createTime}}</view><view class="right-media-type">{{row.$orig.content}}</view></view></block><block wx:if="{{row.$orig.sendId==account}}"><view class="other"><block wx:if="{{row.$orig.mediaType!=3}}"><view class="right"><view class="right-time">{{row.$orig.createTime}}</view><view class="other"><view class="left"><image style="border-radius:100rpx;" src="{{img}}"></image></view><block wx:if="{{row.$orig.mediaType==1}}"><view class="bubble"><rich-text nodes="{{row.g0}}"></rich-text></view></block><block wx:if="{{row.$orig.mediaType==6}}"><view data-event-opts="{{[['tap',[['playVoice',['$0','$1'],[[['messageList','',index,'content']],[['messageList','',index,'id']]]]]]]}}" class="{{['bubble voice',playMsgid==row.$orig.id?'play':'']}}" bindtap="__e"><view class="icon other-voice"></view><view class="length">{{row.$orig.length+"''"}}</view></view></block><block wx:if="{{row.$orig.mediaType==2}}"><view data-event-opts="{{[['tap',[['showPic',['$0'],[[['messageList','',index,'content']]]]]]]}}" class="bubble img" bindtap="__e"><image lazy-load="{{true}}" mode="aspectFill" src="{{row.$orig.content+'?x-oss-process=image/resize,l_150'}}"></image></view></block><block wx:if="{{row.$orig.mediaType==5}}"><view data-event-opts="{{[['tap',[['toGoodDetail',['$0'],[[['messageList','',index,'goods.id']]]]]]]}}" class="bubble recommend" style="justify-content:flex-start;align-items:flex-start;align-self:flex-start;background-color:#FFFFFF;" bindtap="__e"><image mode="aspectFill" src="{{row.$orig.goods.img}}"></image><view class="view-recommend"><view class="txt-name">{{row.$orig.goods.name}}</view><view class="txt-subtitle">{{row.$orig.goods.subTitle}}</view></view></view></block></view></view></block></view></block></view></block></scroll-view></view><view data-event-opts="{{[['touchmove',[['discard',['$event']]]]]}}" class="{{['popup-layer',popupLayerClass]}}" catchtouchmove="__e"><view class="{{['more-layer',(hideMore)?'hidden':'']}}"><view class="list"><view style="display:flex;justify-content:center;flex-direction:column;"><view data-event-opts="{{[['tap',[['getImage',['$event']]]]]}}" class="box" bindtap="__e"><image style="width:50rpx;height:40rpx;" src="../../static/image/icon_tp1.png" mode="aspectFill"></image></view><view style="width:100%;text-align:center;">图片</view></view><view style="display:flex;justify-content:center;flex-direction:column;"><view data-event-opts="{{[['tap',[['getVideo',['$event']]]]]}}" class="box" bindtap="__e"><image style="width:50rpx;height:40rpx;" src="../../static/image/icon_sp.png" mode="aspectFill"></image></view><view style="width:100%;text-align:center;">视频</view></view></view></view></view><view data-event-opts="{{[['touchmove',[['discard',['$event']]]]]}}" class="{{['input-box',popupLayerClass]}}" catchtouchmove="__e"><view class="voice"><view data-event-opts="{{[['tap',[['switchVoice',['$event']]]]]}}" class="{{['icon',isVoice?'jianpan':'yuyin']}}" bindtap="__e"></view></view><view class="textbox"><view data-event-opts="{{[['touchstart',[['voiceBegin',['$event']]]],['touchmove',[['voiceIng',['$event']]]],['touchend',[['voiceEnd',['$event']]]],['touchcancel',[['voiceCancel',['$event']]]]]}}" class="{{['voice-mode',isVoice?'':'hidden',recording?'recording':'']}}" bindtouchstart="__e" catchtouchmove="__e" bindtouchend="__e" bindtouchcancel="__e">{{voiceTis}}</view><view class="{{['text-mode',isVoice?'hidden':'']}}"><view class="box"><textarea cursor-spacing="20" focus="{{focus}}" auto-height="true" data-event-opts="{{[['focus',[['textareaFocus',['$event']]]],['input',[['__set_model',['','textMsg','$event',[]]]]]]}}" value="{{textMsg}}" bindfocus="__e" bindinput="__e"></textarea></view></view></view><view data-event-opts="{{[['tap',[['showMore',['$event']]]]]}}" class="more" bindtap="__e"><view class="icon add"></view></view><view data-event-opts="{{[['touchend',[['sendText',['$event']]]]]}}" class="{{['send',isVoice?'hidden':'']}}" bindtouchend="__e"><view class="btn">发送</view></view></view><view class="{{['record',recording?'':'hidden']}}"><view class="{{['ing',willStop?'hidden':'']}}"><view class="icon luyin2"></view></view><view class="{{['cancel',willStop?'':'hidden']}}"><view class="icon chehui"></view></view><view class="{{['tis',willStop?'change':'']}}">{{recordTis}}</view></view></view>