(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/prescription-submit-cen/prescription-submit-cen"],{"098d":function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=i(n("f96d"));function i(t){return t&&t.__esModule?t:{default:t}}var s={components:{myh5:a.default},onLoad:function(e){var n=this;if(e.scene){console.log("has scene");var a=decodeURIComponent(e.scene);console.log("scene is ",a);var i=a.split("=");console.log("setStorageSync:",i[0],"=",i[1]),this.id=i[1],this.getDetailData()}else console.log("no scene"),console.log("处方i"+JSON.stringify(e)),JSON.stringify(e).includes("caseTemplateId")?this.$u.get(this.scanContentUrl,{content:"?caseTemplateId_"+e.caseTemplateId}).then((function(t){0==t.status&&(n.id=t.data,n.getDetailData())})):(this.id=e.caseId,this.getDetailData());this.takeType=this.detailData.takeType,t.$on(this.PRESCRIPTIONPATIENT,(function(t){n.updatePatient(t.id)})),t.$on(this.UPADDRESS,(function(t){console.log("更换收货地址"),console.log(t.id),n.getUpdateAddress(t.id)})),t.$on(this.ADDADDRESS,(function(t){n.getMoAddress()})),t.$on(this.ADDPATIENT,(function(t){n.getDetailData()}))},onUnload:function(){t.$off(this.PRESCRIPTIONPATIENT),t.$off(this.UPADDRESS),t.$off(this.ADDADDRESS),t.$off(this.ADDPATIENT)},data:function(){return{id:"",detailData:"",payShow:!1,payType:!1,takeType:""}},methods:{handleHiddenShare:function(){var e=this,n=this,a=this.payType?1:2;this.$u.get(this.orderCaseSubmitUrl,{caseId:this.id,platform:a,deviceType:t.getStorageSync(this.DEVICETYPE)}).then((function(t){console.log("提交订单"),console.log(t),0==t.status&&(e.payType?n.zfbApi(t.data.body):n.wxPay(t.data))}))},wxPay:function(e){t.requestPayment({provider:"wxpay",timeStamp:e.timestamp,nonceStr:e.noncestr,package:e.packagevalue,signType:"MD5",paySign:e.sign,success:function(t){console.log("微信支付成功回调")},fail:function(t){console.log("微信支付失败回调:"+JSON.stringify(t))}})},wxApi:function(e){t.requestPayment({provider:"wxpay",orderInfo:e,success:function(t){console.log("success:"+JSON.stringify(t))},fail:function(t){console.log("fail:"+JSON.stringify(t))}})},zfbApi:function(e){t.requestPayment({provider:"alipay",orderInfo:e,success:function(t){console.log("success:"+JSON.stringify(t))},fail:function(t){console.log("fail:"+JSON.stringify(t))}})},getUpdateAddress:function(t){var e=this;console.log("订单id"),console.log(this.id),console.log("订单地址id"),console.log(t),this.$u.get(this.caseSetDetailUrl,{caseId:this.id,takeType:this.takeType,addressId:t}).then((function(t){console.log(t),0==t.status&&(e.detailData=t.data)}))},updatePatient:function(e){var n=this;this.$u.get(this.caseSetPatientUrl,{caseId:this.id,patientId:e}).then((function(e){console.log(e),0==e.status&&(n.getDetailData(),t.$emit(n.PRESCRIPTIONPATIENTT,""))}))},toAddPatient:function(){t.navigateTo({url:"../../ApagesA/authentication/authentication?type=2"})},addAddress:function(){t.navigateTo({url:"../../ApagesA/address-add/address-add?type=3"})},updateAddress:function(){t.navigateTo({url:"../need-update-address/need-update-address?type=2&addressData="+encodeURIComponent(JSON.stringify(this.detailData.customerAddress))})},updateUser:function(){t.navigateTo({url:"../need-update-user/need-update-user?type=2&userData="+encodeURIComponent(JSON.stringify(this.detailData.patient))})},setTakeOne:function(){var t=this;this.takeType=1,this.$u.test.isEmpty(this.detailData.customerAddress)?this.$u.get(this.addressDefaultUrl).then((function(e){console.log("获取默认收货人"),console.log(e),0==e.status&&t.setTake(e.data.id)})).catch((function(e){4==e.status&&(console.log("获取默认收货人没数据"),console.log(e),t.detailData.customerAddress=null)})):this.setTake(this.detailData.customerAddress.id)},getMoAddress:function(){var t=this;this.$u.get(this.addressDefaultUrl).then((function(e){0==e.status&&(t.detailData.customerAddress=e.data)}))},setTake:function(t){var e=this;this.$u.get(this.caseSetDetailUrl,{caseId:this.id,takeType:this.takeType,addressId:t}).then((function(t){console.log(t),0==t.status&&(e.detailData=t.data)}))},setTakeZero:function(){var t=this;this.takeType=0,console.log("设置到店自取参数"),console.log(this.id),console.log(this.takeType),this.$u.get(this.caseSetDetailUrl,{caseId:this.id,takeType:this.takeType}).then((function(e){console.log(e),0==e.status&&(t.detailData=e.data)}))},getDetailData:function(){var e=this;console.log("处方"+this.id),t.showLoading(),this.$u.get(this.scanContentUrl,{content:"a?caseId="+this.id}).then((function(n){t.hideLoading(),0==n.status&&(e.detailData=n.data,e.takeType=e.detailData.takeType)})).catch((function(n){t.hideLoading(),1==n.data.status&&(e.$u.toast(n.data.msg),setTimeout((function(){t.navigateBack()}),1e3))}))},checkPay:function(t){t||(this.payType=!this.payType)},isHaveAddress:function(){1==this.takeType&&this.$u.test.isEmpty(this.detailData.customerAddress)?this.$u.toast("请先添加收货地址"):this.$u.test.isEmpty(this.detailData.patient)?this.$u.toast("请先添加就诊人"):this.payPopup()},payPopup:function(){this.payShow=!this.payShow}}};e.default=s}).call(this,n("543d")["default"])},3252:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return a}));var a={tuiBottomPopup:function(){return n.e("ui/tui-bottom-popup/tui-bottom-popup").then(n.bind(null,"54a2"))}},i=function(){var t=this,e=t.$createElement,n=(t._self._c,this.$u.test.isEmpty(t.detailData.remark)),a=this.$u.test.isEmpty(t.detailData.remark);t.$mp.data=Object.assign({},{$root:{g0:n,g1:a}})},s=[]},6697:function(t,e,n){"use strict";n.r(e);var a=n("c000"),i=n.n(a);for(var s in a)"default"!==s&&function(t){n.d(e,t,(function(){return a[t]}))}(s);e["default"]=i.a},"670e":function(t,e,n){"use strict";var a=n("84a2"),i=n.n(a);i.a},"84a2":function(t,e,n){},8943:function(t,e,n){"use strict";(function(t){n("77c6");a(n("66fd"));var e=a(n("b275"));function a(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("543d")["createPage"])},b275:function(t,e,n){"use strict";n.r(e);var a=n("3252"),i=n("fdeb");for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);n("f38b");var o,d=n("f0c5"),c=Object(d["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],o);e["default"]=c.exports},c000:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a={name:"myh5",props:["docId"],data:function(){return{src:"",modal:!1,loading:!1}},onLoad:function(){console.log("的粉红色"+this.docI),this.docId&&this.downloadApp()},methods:{handleClick:function(){this.modal=!1},isWeiXinBrowser:function(){var t=window.navigator.userAgent.toLowerCase();return"micromessenger"==t.match(/MicroMessenger/i)},download:function(){window.location.href=this.h5APPPath},download2:function(){this.loading=!0,this.src=this.AppStorePath},downloadApp:function(){var t=this;this.$u.get(this.VersionPlatformUrl).then((function(e){0==e.status&&("Android"==e.msg?t.download():"iPhone"==e.msg&&t.download2())}))}}};e.default=a},cdaa:function(t,e,n){},d1b7:function(t,e,n){"use strict";var a;n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return a}));var i=function(){var t=this,e=t.$createElement;t._self._c},s=[]},f38b:function(t,e,n){"use strict";var a=n("cdaa"),i=n.n(a);i.a},f96d:function(t,e,n){"use strict";n.r(e);var a=n("d1b7"),i=n("6697");for(var s in i)"default"!==s&&function(t){n.d(e,t,(function(){return i[t]}))}(s);n("670e");var o,d=n("f0c5"),c=Object(d["a"])(i["default"],a["b"],a["c"],!1,null,null,null,!1,a["a"],o);e["default"]=c.exports},fdeb:function(t,e,n){"use strict";n.r(e);var a=n("098d"),i=n.n(a);for(var s in a)"default"!==s&&function(t){n.d(e,t,(function(){return a[t]}))}(s);e["default"]=i.a}},[["8943","common/runtime","common/vendor"]]]);